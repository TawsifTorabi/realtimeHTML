
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice Image</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
        }
        #invoiceCanvas {
            display: none;
        }
        .download-btn {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            font-size: 14px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        .download-btn:hover {
            background-color: #45a049;
        }
        #imagePreview {
            margin: 20px auto;
            max-width: 400px;
            display: none;
        }
      .pt-mono-regular {
        font-family: "PT Mono", monospace;
        font-weight: 400;
        font-style: normal;
      }
    </style>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=PT+Mono&display=swap" rel="stylesheet">
</head>
<body>

<button class="download-btn" onclick="generateInvoiceImage(invoiceData)">Generate Invoice Preview</button>
<img id="imagePreview" alt="Invoice Preview" />

<canvas id="invoiceCanvas" width="400" height="500"></canvas>

<script>
    // Invoice data object
    const invoiceData = {
        invoiceNumber: '14325945134',
        customer: {
            name: 'Example',
            phone: 'Example',
            address: 'Example'
        },
        products: [
            { number: 1, name: 'Key Chain', qty: 2, unitPrice: 100, total: 200 },
          	{ number: 2, name: 'T shirt  ', qty: 2, unitPrice: 100, total: 200 }
        ],
        summary: {
            totalProductPrice: 200,
            deliveryCharge: 60,
            grandTotal: 260,
            advancePayment: 60,
            cashOnDelivery: 200
        },
        footerText: 'Generated by dynaSale'
    };

    function generateInvoiceImage(data) {
        const canvas = document.getElementById('invoiceCanvas');
        const ctx = canvas.getContext('2d');
        
        // Clear the canvas for each new generation
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Set background color
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Set text color and font
        ctx.fillStyle = '#000000';
        ctx.font = '12px "PT Mono", monospace';

        // Invoice Header
        ctx.font = '27px "PT Mono", monospace'; // Increase font size for the invoice number
        ctx.fillText(`Invoice #${data.invoiceNumber}`, 10, 20);
        ctx.font = '12px "PT Mono", monospace'; // Reset font size for the rest
        ctx.fillText(`Customer Name: ${data.customer.name}`, 10, 40);
        ctx.fillText(`Phone: ${data.customer.phone}`, 10, 60);
        ctx.fillText(`Address: ${data.customer.address}`, 10, 80);

        // Product Table Header
        ctx.fillText('No.    Product           Qty    Unit   Total', 10, 100);
        ctx.fillText('____________________________________________________', 10, 110);

        // Product Details
        let yPosition = 130;
        data.products.forEach(product => {
            ctx.fillText(`${product.number}      ${product.name}        ${product.qty}      ${product.unitPrice}     ${product.total}`, 10, yPosition);
            yPosition += 20;
        });

        // Summary
        ctx.fillText('____________________________________________________', 10, yPosition + 10);
        yPosition += 30;

        ctx.fillText(`Total Product Price                    ${data.summary.totalProductPrice + ' Taka'}`, 10, yPosition);
        yPosition += 20;
        ctx.fillText(`Delivery Charge                        ${data.summary.deliveryCharge  + ' Taka'}`, 10, yPosition);
        yPosition += 20;
        ctx.fillText('____________________________________________________', 10, yPosition);
        yPosition += 20;
        ctx.fillText(`Grand Total                            ${data.summary.grandTotal  + ' Taka'}`, 10, yPosition);
        yPosition += 20;
        ctx.fillText(`Advance Payment                        ${data.summary.advancePayment  + ' Taka'}`, 10, yPosition);
        yPosition += 20;
        ctx.font = '15px "PT Mono", monospace';
        ctx.fillText(`Cash on Delivery               ${data.summary.cashOnDelivery  + ' Taka'}`, 10, yPosition);

        // Footer
        ctx.font = '8px "PT Mono", monospace';
        ctx.fillText(data.footerText, 10, yPosition + 30);

        // Convert canvas to image and display preview
        const imagePreview = document.getElementById('imagePreview');
        imagePreview.src = canvas.toDataURL();
        imagePreview.style.display = 'block';

        // Prepare for download
        const link = document.createElement('a');
        link.download = `invoice_${data.invoiceNumber}.png`;
        link.href = canvas.toDataURL();
        link.onclick = function() {
            setTimeout(() => {
                //imagePreview.style.display = 'none'; // Hide preview after download
            }, 100);
        };
        //link.click();
    }
</script>

</body>
</html>
